/*!
 * hub.js
 * 
 * @file: hub.min.js
 * @author: lijialiang
 * @version: 0.2.0
 * @update: 2017-12-20 13:34:22
 * 
 * (c) 2017 YY UEDC
 * Released under the MIT License.
 */
!function t(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.$hub=n():e.$hub=n()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function e(){return t.default}:function e(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){"use strict";t.exports={iterator:function t(e,n,r,i){var o=this;2!==arguments.length||r?3!==arguments.length||i?n<e.length?r(e[n],function(){o.iterator(e,++n,r,i)}):n>=e.length-1&&i&&i():this.iterator(e,0,n,r):this.iterator(e,0,n,null)},await:function t(e,n){e.then?e.then(function(t){n&&n(t)}):n&&n(e)}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n(2),o=r(i),u=n(3),f=r(u),c=n(4),a=r(c),s=n(5),_=r(s),v=n(6),d=r(v),h=n(7),l=r(h),p=n(8),m=r(p),y=n(9),b=r(y),g=n(10),O=r(g),j=n(11),x=r(j),k={},w={ws:[],io:[]},E={},M={},P={};t.exports={observer:k,data:E,chainer:P,socket:w,emit:o.default,on:f.default,listen:f.default,off:a.default,removeListen:a.default,store:(0,_.default)(E,k),DOM:d.default,Fetch:l.default,WS:b.default,IO:m.default,chain:O.default,converter:M,once:x.default}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=this.observer,r=this.data,u=this.chainer,f=function f(c){if(0===t.indexOf("@store/")){var a=t.split("@store/")[1];void 0!==r[a]&&(r[a]=e)}if(0===t.indexOf("@chain/")){var s=t.split("@chain/")[1];if(void 0!==u[s])return void i(u[s],e,function(e){o(n,t,e)})}o(n,c,e)};t instanceof Array?t.forEach(function(t){return f(t)}):f(t)};var r=n(0),i=function t(e,n,i){r.iterator(e,function(t,e){r.await(t(n),function(t){n=t,e()})},function(){i(n)})},o=function t(e,n,r){void 0!==e[n]&&e[n].forEach(function(t,e){t(r)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=this,r=this.observer,i=this.data,o=this.chainer,u=function t(n){if(void 0===r[n]&&(r[n]=[]),r[n].push(e),0===n.indexOf("@store/")){var o=n.split("@store/")[1];void 0!==i[o]&&e(i[o])}},f={};return f.key=t,t instanceof Array?(t.forEach(function(t){return u(t)}),f.off=f.remove=function(){return t.forEach(function(t){return n.off(t,e)})}):(u(t),f.off=f.remove=function(){return n.off(t,e)}),f}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=this.observer,r=function t(r){void 0!==n[r]&&n[r].forEach(function(t,i){t==e&&n[r].splice(i,1)})};t instanceof Array?t.forEach(function(t){return r(t)}):r(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return new Proxy({},{get:function e(n,r,i){return t[r]},set:function n(r,i,o,u){if(!t[i]||t[i]!=o){t[i]=o;var f="@store/"+i;void 0!==e[f]&&e[f].forEach(function(t,e){t(o)})}}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this;if(t){var n=void 0;if(n="string"==typeof t?document.body.querySelector(t):t){var i=this.emit,o=this.format,u=this.converter,f={},c=[],a=function t(e){var n=e.type,i=void 0;if(c.forEach(function(t,e){"__from__"===t.type&&t.func===n&&(i=e)}),void 0!==i){var o=c.slice(i+1,c.length);if(o.length>0){var u=e,f=!1;r.iterator(o,function(t,e){if(!f)switch(t.type){case"__convert__":r.await(t.func(u),function(t){u=t,e()});break;case"__emit__":t.func(u),e();break;case"__from__":f=!0,e()}})}}};return f.convert=function(t){return u[t]&&c.push({type:"__convert__",func:u[t]}),f},f.from=function(t){return c.push({type:"__from__",func:t}),n.addEventListener(t,a),f},f.emit=function(t,n){return c.push({type:"__emit__",func:function r(o){n?i.bind(e)(t,{event:o,data:n}):i.bind(e)(t,o)}}),f},f.off=f.remove=function(){c.forEach(function(t,e){"__from__"===t.type&&n.removeEventListener(t.func,a)})},f}}};var r=n(0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t){var i=this.emit,o=this.converter,u=void 0,f={},c=[],a=function t(e){c.length>0&&r.iterator(c,function(t,n){switch(t.type){case"__convert__":r.await(t.func(e),function(t){e=t,n()});break;case"__emit__":t.func(e)}})};return f.convert=function(t){return o[t]&&c.push({type:"__convert__",func:o[t]}),f},f.emit=function(t,n){return c.push({type:"__emit__",func:function r(o){n?i.bind(e)(t,{result:o,data:n}):i.bind(e)(t,o)}}),u&&clearTimeout(u),u=setTimeout(function(){f.reload()},0),f},f.reload=function(){fetch(t,n).then(function(t){200===t.status&&t.json?t.json().then(function(t){return a(t)}):a(t)}).catch(function(t){a(t)})},f}};var r=n(0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this,n=this.emit,i=this.socket,o=this.converter;if(t){var u={},f=[],c=io(t);u.socket=c,i.io.push({url:t,socket:i});var a=function t(e,n){var i=void 0;if(f.forEach(function(t,n){"__from__"===t.type&&t.func===e&&(i=n)}),void 0!==i){var o=f.slice(i+1,f.length);if(o.length>0){var u=n,c=!1;r.iterator(o,function(t,e){if(!c)switch(t.type){case"__convert__":r.await(t.func(u),function(t){u=t,e()});break;case"__emit__":t.func(u),e();break;case"__from__":c=!0,e()}})}}};return u.convert=function(t){return o[t]&&f.push({type:"__convert__",func:o[t]}),u},u.from=function(t){var e=function e(n){a(t,n)};return f.push({type:"__from__",func:t,_eventListener:e}),c.on(t,e),u},u.emit=function(t,r){return f.push({type:"__emit__",func:function i(o){r?n.bind(e)(t,{event:o,data:r}):n.bind(e)(t,o)}}),u},u.off=u.remove=function(){f.forEach(function(t,e){"__from__"===t.type&&c.off(t.func,t._eventListener)})},u}};var r=n(0)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this,n=this.emit,i=this.socket,o=this.converter;if(t){var u={},f=[],c=new WebSocket(t);i.ws.push({url:t,socket:i}),u.socket=c;var a=function t(e){if(e.data)try{s(JSON.parse(e.data))}catch(t){s(e.data)}else s(e)};c.addEventListener("message",a);var s=function t(e){if(f.length>0){var n=e;r.iterator(f,function(t,e){switch(t.type){case"__convert__":r.await(t.func(n),function(t){n=t,e()});break;case"__emit__":t.func(n),e()}})}};return u.convert=function(t){return o[t]&&f.push({type:"__convert__",func:o[t]}),u},u.emit=function(t,r){return f.push({type:"__emit__",func:function i(o){r?n.bind(e)(t,{result:o,data:r}):n.bind(e)(t,o)}}),u},u.off=u.remove=function(){c.removeEventListener("message",a)},u}};var r=n(0)},function(t,e,n){"use strict";t.exports=function(t){var e=this.chainer,n={};return n.pipe=function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return e[t]?e[t]=e[t].concat(i):e[t]=i,n},n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=this.observer,r=this.data,i=this.chainer,o=this.on(t,function(t){e(t),o.off()})}}])});